{"version":3,"file":"script.js","sources":["src/index.js"],"sourcesContent":["import { Validation, Type } from 'main.core';\nimport { BitrixVue } from 'ui.vue3';\n\nexport type SystemAuthRegistrationParamsType = {\n\tcontainerNode: HTMLElement,\n\tisEmailRequired: 'Y' | 'N',\n\tisConfirmRegistrationBlockVisible: 'Y' | 'N',\n\tisCaptchaAvailable: 'Y' | 'N',\n\tuserName: string | '',\n\tuserLastName: string | '',\n\tuserEmail: string | '',\n\tuserLogin: string | '',\n}\n\nexport class SystemAuthRegistration\n{\n\t#application;\n\t#rootNode: HTMLElement;\n\t#isEmailRequired: boolean;\n\t#isConfirmRegistrationBlockVisible: boolean;\n\t#isCaptchaAvailable: boolean;\n\t#userName: string;\n\t#userLastName: string;\n\t#userEmail: string;\n\t#userLogin: string;\n\n\tconstructor(params: SystemAuthRegistrationParamsType): void\n\t{\n\t\tthis.#rootNode = params.containerNode;\n\t\tthis.#isEmailRequired = params.isEmailRequired === 'Y';\n\t\tthis.#isConfirmRegistrationBlockVisible = params.isConfirmRegistrationBlockVisible === 'Y';\n\t\tthis.#isCaptchaAvailable = params.isCaptchaAvailable === 'Y';\n\t\tthis.#userName = params.userName ?? '';\n\t\tthis.#userLastName = params.userLastName ?? '';\n\t\tthis.#userEmail = params.userEmail ?? '';\n\t\tthis.#userLogin = params.userLogin ?? '';\n\t\tthis.#initVueApp();\n\t\tBX.UI.Hint.init(this.#rootNode);\n\t}\n\n\t#initVueApp(): void\n\t{\n\t\tconst context = this;\n\n\t\tthis.#application = BitrixVue.createApp({\n\t\t\tname: 'SystemAuthRegistration',\n\t\t\tdata()\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tisNameBlockVisible: true,\n\t\t\t\t\tisPasswordBlockVisible: false,\n\t\t\t\t\tisCaptchaBlockVisible: false,\n\t\t\t\t\tisBackButtonVisible: false,\n\t\t\t\t\tuserName: this.getApplication().#userName,\n\t\t\t\t\tuserLastName:  this.getApplication().#userLastName,\n\t\t\t\t\tuserEmail: this.getApplication().#userEmail,\n\t\t\t\t\tuserLogin: this.getApplication().#userLogin,\n\t\t\t\t\tisEmailRequired: this.getApplication().#isEmailRequired,\n\t\t\t\t\tisConfirmRegistrationBlockVisible: this.getApplication().#isConfirmRegistrationBlockVisible,\n\t\t\t\t\tisCaptchaAvailable: this.getApplication().#isCaptchaAvailable,\n\t\t\t\t\tisWaiting: false,\n\t\t\t\t\tinputPasswordType: 'password',\n\t\t\t\t\tinputConfirmPasswordType: 'password',\n\t\t\t\t};\n\t\t\t},\n\t\t\tbeforeCreate(): void\n\t\t\t{\n\t\t\t\tthis.$bitrix.Application.set(context);\n\t\t\t},\n\t\t\tcomputed: {\n\t\t\t\tfullName(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.toFullName();\n\t\t\t\t},\n\t\t\t\temail(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.userEmail;\n\t\t\t\t},\n\t\t\t\tactiveOrDisabledButtonClass(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.isEnteredValidLoginAndEmail() ? 'ui-btn-success' : 'ui-btn-disabled';\n\t\t\t\t},\n\t\t\t},\n\t\t\tmounted(): void\n\t\t\t{\n\t\t\t\tif (this.$refs && Type.isDomNode(this.$refs.modalInput))\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.modalInput.focus();\n\t\t\t\t}\n\t\t\t},\n\t\t\tmethods: {\n\t\t\t\tonButtonClick(event): void\n\t\t\t\t{\n\t\t\t\t\tif (this.isNameBlockVisible)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\tif (this.isEnteredValidLoginAndEmail())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.showPasswordBlock();\n\t\t\t\t\t\t\tthis.isBackButtonVisible = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.isPasswordBlockVisible && this.isCaptchaAvailable)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tthis.showCaptchaBlock();\n\t\t\t\t\t\tthis.isBackButtonVisible = true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.isWaiting = true;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tonBackButtonClick(): void\n\t\t\t\t{\n\t\t\t\t\tif (this.isPasswordBlockVisible)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showNameBlock();\n\t\t\t\t\t\tthis.isBackButtonVisible = false;\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.isCaptchaAvailable && this.isCaptchaBlockVisible)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showPasswordBlock();\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tshowNameBlock(): void\n\t\t\t\t{\n\t\t\t\t\tthis.isNameBlockVisible = true;\n\t\t\t\t\tthis.isPasswordBlockVisible = false;\n\t\t\t\t\tthis.isCaptchaBlockVisible = false;\n\t\t\t\t},\n\n\t\t\t\tshowPasswordBlock(): void\n\t\t\t\t{\n\t\t\t\t\tthis.isNameBlockVisible = false;\n\t\t\t\t\tthis.isPasswordBlockVisible = true;\n\t\t\t\t\tthis.isCaptchaBlockVisible = false;\n\t\t\t\t},\n\n\t\t\t\tshowCaptchaBlock(): void\n\t\t\t\t{\n\t\t\t\t\tthis.isNameBlockVisible = false;\n\t\t\t\t\tthis.isPasswordBlockVisible = false;\n\t\t\t\t\tthis.isCaptchaBlockVisible = true;\n\t\t\t\t},\n\n\t\t\t\ttoFullName(): string\n\t\t\t\t{\n\t\t\t\t\tconst nameSplitter = this.userName !== '' && this.userLastName !== ''\n\t\t\t\t\t\t? ' '\n\t\t\t\t\t\t: ''\n\t\t\t\t\t;\n\n\t\t\t\t\treturn `${this.userName}${nameSplitter}${this.userLastName}`;\n\t\t\t\t},\n\n\t\t\t\tonEnterUserEmail(value: string): void\n\t\t\t\t{\n\t\t\t\t\tthis.userEmail = value;\n\t\t\t\t},\n\n\t\t\t\tisEmailEnteredCorrectly(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn Validation.isEmail(this.userEmail);\n\t\t\t\t},\n\n\t\t\t\tonEnterUserLogin(value: string): void\n\t\t\t\t{\n\t\t\t\t\tthis.userLogin = value;\n\t\t\t\t},\n\n\t\t\t\tisLoginEnteredCorrectly(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn (this.userLogin.length >= 3);\n\t\t\t\t},\n\n\t\t\t\tonEnterUserName(value: string): void\n\t\t\t\t{\n\t\t\t\t\tthis.userName = value;\n\t\t\t\t},\n\n\t\t\t\tonEnterUserLastName(value: string): void\n\t\t\t\t{\n\t\t\t\t\tthis.userLastName = value;\n\t\t\t\t},\n\n\t\t\t\tisEnteredValidLoginAndEmail(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn (\n\t\t\t\t\t\tthis.isLoginEnteredCorrectly()\n\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\t!this.isEmailRequired ||\n\t\t\t\t\t\t\tthis.isEmailRequired && this.isEmailEnteredCorrectly()\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t},\n\n\t\t\t\tonEyeMouseDown(inputElementName): void\n\t\t\t\t{\n\t\t\t\t\tif (inputElementName === 'PASSWORD')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.inputPasswordType = 'text';\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.inputConfirmPasswordType = 'text';\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tonEyeMouseUp(inputElementName): void\n\t\t\t\t{\n\t\t\t\t\tif (inputElementName === 'PASSWORD')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.inputPasswordType = 'password';\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.inputConfirmPasswordType = 'password';\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tgetApplication()\n\t\t\t\t{\n\t\t\t\t\treturn this.$bitrix.Application.get();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tthis.#application.mount(this.#rootNode);\n\t}\n}"],"names":["SystemAuthRegistration","params","containerNode","isEmailRequired","isConfirmRegistrationBlockVisible","isCaptchaAvailable","userName","userLastName","userEmail","userLogin","BX","UI","Hint","init","context","BitrixVue","createApp","name","data","isNameBlockVisible","isPasswordBlockVisible","isCaptchaBlockVisible","isBackButtonVisible","getApplication","isWaiting","inputPasswordType","inputConfirmPasswordType","beforeCreate","$bitrix","Application","set","computed","fullName","toFullName","email","activeOrDisabledButtonClass","isEnteredValidLoginAndEmail","mounted","$refs","Type","isDomNode","modalInput","focus","methods","onButtonClick","event","preventDefault","showPasswordBlock","showCaptchaBlock","onBackButtonClick","showNameBlock","nameSplitter","onEnterUserEmail","value","isEmailEnteredCorrectly","Validation","isEmail","onEnterUserLogin","isLoginEnteredCorrectly","length","onEnterUserName","onEnterUserLastName","onEyeMouseDown","inputElementName","onEyeMouseUp","get","mount"],"mappings":"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"}