this.BX=this.BX||{};(function(e,t){"use strict";var i=new WeakMap;var s=new WeakMap;var a=new WeakMap;var r=new WeakMap;var o=function(){function e(o){babelHelpers.classCallCheck(this,e);i.set(this,{writable:true,value:void 0});s.set(this,{writable:true,value:void 0});a.set(this,{writable:true,value:void 0});r.set(this,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,i,o.authContainerNode);babelHelpers.classPrivateFieldSet(this,s,o.isQrAvailable==="Y");babelHelpers.classPrivateFieldSet(this,a,o.qrText||"");babelHelpers.classPrivateFieldSet(this,r,o.qrConfig||"");if(!t.Type.isDomNode(babelHelpers.classPrivateFieldGet(this,i))){return}this.buttonNode=babelHelpers.classPrivateFieldGet(this,i).querySelector("[data-role='auth-form-button']");this.init();if(babelHelpers.classPrivateFieldGet(this,s)){this.initQrCode()}}babelHelpers.createClass(e,[{key:"init",value:function e(){var s=this;BX.UI.Hint.init(babelHelpers.classPrivateFieldGet(this,i));if(t.Type.isDomNode(this.buttonNode)){t.Event.bind(this.buttonNode,"click",(function(){var e=s.buttonNode.querySelector(".intranet-text-btn__spinner");if(t.Type.isDomNode(e)){t.Dom.style(e,"display","block")}}))}}},{key:"initQrCode",value:function e(){var t=this;new QRCode("bx_auth_qr_code",{text:babelHelpers.classPrivateFieldGet(this,a),width:220,height:220,colorDark:"#000000",colorLight:"#ffffff"});if(!babelHelpers.classPrivateFieldGet(this,r)){return}this.qrCodeSuccessIcon=babelHelpers.classPrivateFieldGet(this,i).querySelector(".b24net-qr-scan-form__code-overlay");var s=new BX.PullClient;s.subscribe({moduleId:"main",command:"qrAuthorize",callback:function e(i){if(i.token){t.showQrCodeSuccessIcon();BX.ajax.runAction("main.qrcodeauth.authenticate",{data:{token:i.token,remember:BX("USER_REMEMBER_QR")&&BX("USER_REMEMBER_QR").checked?1:0}}).then((function(e){t.hideQrCodeSuccessIcon();if(e.status==="success"){window.location=i.redirectUrl!==""?i.redirectUrl:window.location}}))}}});s.start(babelHelpers.classPrivateFieldGet(this,r))}},{key:"showQrCodeSuccessIcon",value:function e(){if(!t.Type.isDomNode(this.qrCodeSuccessIcon)){return}t.Dom.addClass(this.qrCodeSuccessIcon,"b24net-qr-scan-form__code-overlay--active")}},{key:"hideQrCodeSuccessIcon",value:function e(){if(!t.Type.isDomNode(this.qrCodeSuccessIcon)){return}t.Dom.removeClass(this.qrCodeSuccessIcon,"b24net-qr-scan-form__code-overlay--active")}}]);return e}();e.SystemAuthAuthorize=o})(this.BX.Intranet=this.BX.Intranet||{},BX);
//# sourceMappingURL=script.map.js