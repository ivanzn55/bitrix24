{"version":3,"file":"bitrix24.bundle.js","sources":["../src/js/partner-form/show-partner-connect-form.js","../src/js/partner-form/show-partner-order-form.js","../src/js/partner-form/show-helper.js","../src/js/partner-form/partner-form.js","../src/js/chat-menu.js","../src/js/helpers.js","../src/js/skeletons/create-toolbar-skeleton.js","../src/js/skeletons/create-actions-bar-skeleton.js","../src/js/skeletons/create-grid-skeleton.js","../src/js/skeletons/create-kanban-skeleton.js","../src/js/composite.js","../src/js/right-bar.js","../src/js/header/header.js","../src/js/footer.js","../src/js/go-top-button.js","../src/js/collaboration-menu.js","../src/js/site-template.js","../src/js/header/search-title.js","../src/js/header/avatar-button.js","../src/js/header/license-button.js","../src/js/header/invitation-button.js","../src/js/language-switcher.js","../src/index.js"],"sourcesContent":["import { Loc, Runtime } from 'main.core';\nimport { type Popup as PopupInstance, type PopupOptions } from 'main.popup';\n\nexport type ShowPartnerFormParams = {\n\tpartnerId: string;\n\tpartnerName: string;\n\tpartnerUrl: string;\n\tforms: PartnerForm[] | null;\n\tmessages: { [string]: string }\n};\n\nexport async function showPartnerConnectForm(params: ShowPartnerFormParams)\n{\n\tLoc.setMessage(params.messages);\n\tawait showPartnerFormPopup({\n\t\t...params,\n\t\ttitleBar: Loc.getMessage('PARTNER_POPUP_TITLE'),\n\t\tsendButtonText: Loc.getMessage('PARTNER_POPUP_SEND_BUTTON'),\n\t});\n}\n\ntype ShowPartnerFormPopupOptions = {\n\tforms: PartnerForm[] | null;\n\ttitleBar: string;\n\tsendButtonText: string;\n\tpartnerId: string;\n\tpartnerName: string;\n\tpartnerUrl: string;\n\tarParams: Object;\n}\nasync function showPartnerFormPopup(options: ShowPartnerFormPopupOptions): Popup\n{\n\tconst titleBar = options.titleBar;\n\tconst sendButtonText = options.sendButtonText;\n\tconst partnerName = options.partnerName;\n\tconst partnerUrl = options.partnerUrl;\n\n\tconst [{ Popup }, { Button, ButtonColor }] = await Promise.all([\n\t\tRuntime.loadExtension('main.popup'),\n\t\tRuntime.loadExtension('ui.buttons'),\n\t]);\n\n\tconst popupOptions: PopupOptions = {\n\t\tclassName: 'bitrix24-partner__popup',\n\t\tautoHide: false,\n\t\tcacheable: false,\n\t\tzIndex: 0,\n\t\toffsetLeft: 0,\n\t\toffsetTop: 0,\n\t\twidth: 540,\n\t\theight: 350,\n\t\toverlay: true,\n\t\tdraggable: { restrict: true },\n\t\tcloseByEsc: true,\n\t\ttitleBar,\n\t\tcloseIcon: true,\n\t\tcontent: `\n\t\t\t<div class=\"bitrix24-partner__popup-content\">\n\t\t\t\t<div class=\"bitrix24-partner__popup-content_title\">${Loc.getMessage('PARTNER_TITLE_FOR_NAME')}</div>\n\t\t\t\t<div class=\"bitrix24-partner__popup-content_main\">\n\t\t\t\t\t<div class=\"bitrix24-partner__popup-content_name\">${partnerName}</div>\n\t\t\t\t\t<a class=\"bitrix24-partner__popup-content_link\" href=\"${encodeURI(partnerUrl)}\" target=\"_blank\">${Loc.getMessage('PARTNER_LINK_NAME_MORE')}</a>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bitrix24-partner__popup-content_desc\">${Loc.getMessage('PARTNER_POPUP_DESCRIPTION_BOTTOM')}</div>\n\t\t\t</div>\n\t\t`,\n\t\tbuttons: [\n\t\t\tnew Button({\n\t\t\t\tcolor: ButtonColor.SUCCESS,\n\t\t\t\ttext: sendButtonText,\n\t\t\t\tonclick: async (button: Button) => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tbutton.setClocking(true);\n\t\t\t\t\t}, 200);\n\t\t\t\t\tawait showIntegratorApplicationForm();\n\t\t\t\t\tbutton.setClocking(false);\n\t\t\t\t},\n\t\t\t}),\n\t\t],\n\t};\n\n\tconst popup: PopupInstance = new Popup(popupOptions);\n\n\tpopup.show();\n}\n\nasync function showIntegratorApplicationForm(): void\n{\n\tconst { PartnerForm } = await Runtime.loadExtension('ui.feedback.partnerform');\n\tconst formParams = {\n\t\tid: `intranet-license-partner-form-${parseInt(Math.random() * 1000, 10)}`,\n\t\tsource: 'intranet.bitrix24.partner-connect-form',\n\t};\n\n\tPartnerForm.show(formParams);\n}\n","import { Runtime, Text, Type } from 'main.core';\n\nexport type ShowPartnerOrderFormParams = {\n\ttitle: string | null;\n\tsource: string;\n};\n\nexport async function showPartnerOrderForm(params: ShowPartnerOrderFormParams)\n{\n\tif (Type.isObject(params) === false)\n\t{\n\t\treturn;\n\t}\n\n\tconst resultParams = {\n\t\t...params,\n\t\tid: `intranet-license-partner-form-${Text.getRandom()}`,\n\t};\n\n\tconst { PartnerForm } = await Runtime.loadExtension('ui.feedback.partnerform');\n\n\tPartnerForm.show(resultParams);\n}\n","import { Runtime, Reflection } from 'main.core';\n\nexport const showHelper = async (): Promise<void> => {\n\tawait Runtime.loadExtension('helper');\n\tconst Helper = Reflection.getClass('BX.Helper');\n\n\tHelper.show('redirect=detail&code=20267044');\n};\n","import { showPartnerConnectForm, type ShowPartnerFormParams } from './show-partner-connect-form';\nimport { showPartnerOrderForm, type ShowPartnerOrderFormParams } from './show-partner-order-form';\nimport { showHelper } from './show-helper';\n\nexport class PartnerForm\n{\n\tstatic async showConnectForm(params: ShowPartnerFormParams): void\n\t{\n\t\treturn showPartnerConnectForm(params);\n\t}\n\n\tstatic showIntegrationOrderForm(params: ShowPartnerOrderFormParams): void\n\t{\n\t\treturn showPartnerOrderForm(params);\n\t}\n\n\tstatic async showHelper(): void\n\t{\n\t\treturn showHelper();\n\t}\n}\n","import { Loc, Reflection } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nexport class ChatMenu\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('IM.Layout:onLayoutChange', this.#handleImLayoutChange.bind(this));\n\t\tEventEmitter.subscribe('IM.Counters:onUpdate', this.#handleCounterUpdate.bind(this));\n\t\tEventEmitter.subscribe('BX.Intranet.Bitrix24.ChatMenu:onSelect', this.#handleChatMenuSelect.bind(this));\n\t}\n\n\tgetChatMenu(): typeof(BX.Main.interfaceButtons) | null\n\t{\n\t\t/**\n\t\t *\n\t\t * @type {BX.Main.interfaceButtonsManager}\n\t\t */\n\t\tconst menuManager = Reflection.getClass('BX.Main.interfaceButtonsManager');\n\t\tif (menuManager)\n\t\t{\n\t\t\treturn menuManager.getById('chat-menu') || null;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetCollaborationMenu(): typeof(BX.Main.interfaceButtons) | null\n\t{\n\t\t/**\n\t\t *\n\t\t * @type {BX.Main.interfaceButtonsManager}\n\t\t */\n\t\tconst menuManager = Reflection.getClass('BX.Main.interfaceButtonsManager');\n\t\tif (menuManager)\n\t\t{\n\t\t\treturn menuManager.getById('top_menu_id_collaboration') || null;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#handleChatMenuSelect(event: BaseEvent): void\n\t{\n\t\tconst data = event.getData();\n\t\tconst { id, entityId } = data;\n\t\tlet target = data.event?.target;\n\t\tif (target)\n\t\t{\n\t\t\ttarget = target.closest('.main-buttons-item-link, .menu-popup-item');\n\t\t}\n\n\t\tconst Public = Reflection.getClass('BX.Messenger.Public');\n\t\tPublic?.openNavigationItem({ id, entityId, target });\n\t}\n\n\t#handleImLayoutChange(event: BaseEvent): void\n\t{\n\t\tconst data = event.getData();\n\n\t\tlet fromItemId = data.from.name.toLowerCase();\n\t\tif (fromItemId === 'market' && data.from.entityId)\n\t\t{\n\t\t\tfromItemId = `${fromItemId}_${data.from.entityId}`;\n\t\t}\n\n\t\tlet toItemId = data.to.name.toLowerCase();\n\t\tif (toItemId === 'market' && data.to.entityId)\n\t\t{\n\t\t\ttoItemId = `${toItemId}_${data.to.entityId}`;\n\t\t}\n\n\t\tconst chatMenu = this.getChatMenu();\n\t\tif (chatMenu !== null)\n\t\t{\n\t\t\tchatMenu.unsetActive(fromItemId);\n\t\t\tchatMenu.setActive(toItemId);\n\t\t\tchatMenu.reset();\n\t\t}\n\n\t\tconst collaborationMenu = this.getCollaborationMenu();\n\t\tconst siteDir = Loc.getMessage('SITE_DIR') || '/';\n\t\tconst isMessengerEmbedded = window.location.pathname.toString().startsWith(`${siteDir}online/`);\n\t\tif (collaborationMenu !== null)\n\t\t{\n\t\t\tif (isMessengerEmbedded)\n\t\t\t{\n\t\t\t\tcollaborationMenu.unsetActive(fromItemId);\n\t\t\t\tcollaborationMenu.setActive(toItemId);\n\t\t\t}\n\n\t\t\tcollaborationMenu.reset();\n\t\t}\n\t}\n\n\t#handleCounterUpdate(event: BaseEvent): void\n\t{\n\t\tconst counters: Object<string, number> = event.getData();\n\t\tconst menus = [this.getChatMenu(), this.getCollaborationMenu()];\n\t\tfor (const menu of menus)\n\t\t{\n\t\t\tif (menu === null)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const [counterId, counterValue] of Object.entries(counters))\n\t\t\t{\n\t\t\t\tmenu.updateCounter(counterId, counterValue);\n\t\t\t}\n\t\t}\n\t}\n}\n","import { Type } from 'main.core';\n\nexport function getBackUrl(): string\n{\n\tconst backUrl = window.location.pathname;\n\tconst query = getQueryString(['logout', 'login', 'back_url_pub', 'user_lang']);\n\n\treturn backUrl + (query.length > 0 ? `?${query}` : '');\n}\n\nfunction getQueryString(ignoredParams): string\n{\n\tconst query = window.location.search.slice(1);\n\n\tif (!Type.isStringFilled(query))\n\t{\n\t\treturn '';\n\t}\n\n\tconst vars = query.split('&');\n\tconst checkedIgnoredParams = Type.isArray(ignoredParams) ? ignoredParams : [];\n\n\tlet result = '';\n\tfor (const variable of vars)\n\t{\n\t\tconst pair = variable.split('=');\n\t\tconst equal = variable.indexOf('=');\n\t\tconst key = pair[0];\n\t\tconst value = Type.isStringFilled(pair[1]) ? pair[1] : false;\n\t\tif (!checkedIgnoredParams.includes(key))\n\t\t{\n\t\t\tif (result !== '')\n\t\t\t{\n\t\t\t\tresult += '&';\n\t\t\t}\n\t\t\tresult += key + (equal === -1 ? '' : '=') + (value === false ? '' : value);\n\t\t}\n\t}\n\n\treturn result;\n}\n","import { Tag } from 'main.core';\n\nimport '../../css/skeletons/composite-toolbar-skeleton.css';\n\nexport type ToolbarSkeletonOptions = {\n\tshowIconButton?: boolean;\n};\n\nexport const createToolbarSkeleton = (options: ToolbarSkeletonOptions = {}): HTMLElement => {\n\tconst { showIconButton = false } = options;\n\n\treturn Tag.render`\n\t\t<div class=\"toolbar-skeleton\">\n\t\t\t<span class=\"toolbar-skeleton__page-title\"></span>\n\t\t\t${showIconButton ? createIconButton() : null}\n\t\t</div>\n\t`;\n};\n\nfunction createIconButton(): HTMLElement\n{\n\treturn Tag.render`\n\t\t<span class=\"toolbar-skeleton__icon-buttons\">\n\t\t\t<span class=\"toolbar-skeleton__icon-button\">\n\t\t\t\t<span class=\"toolbar-skeleton__icon-button-text\"></span>\n\t\t\t</span>\n\t\t</span>\n\t`;\n}\n","import { Dom, Tag } from 'main.core';\n\nimport '../../css/skeletons/composite-actions-bar-skeleton.css';\n\nexport type ActionsBarSkeletonOptions = {\n\tshowNavigationPanel?: boolean;\n\tshowCounterPanel?: boolean;\n\trightButtonsCount?: boolean;\n};\n\nexport const createActionsBarSkeleton = (options: ActionsBarSkeletonOptions = {}): HTMLElement => {\n\tconst { showNavigationPanel = true, showCounterPanel = false, rightButtonsCount = 0 } = options;\n\n\treturn Tag.render`\n\t\t<div class=\"actions-bar-skeleton\">\n\t\t\t${showNavigationPanel ? createNavigationPanelSkeleton() : null}\n\t\t\t${showCounterPanel ? createCounterPanelSkeleton() : null}\n\t\t\t${rightButtonsCount > 0 ? createRightButtons(rightButtonsCount) : null}\n\t\t</div>\n\t`;\n};\n\nfunction createNavigationPanelSkeleton(): HTMLElement\n{\n\treturn Tag.render`\n\t\t<div class=\"navigation-skeleton\">\n\t\t\t\t<div class=\"navigation-skeleton__item\">\n\t\t\t\t\t<div class=\"navigation-skeleton__item-text\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t`;\n}\n\nfunction createCounterPanelSkeleton(): HTMLElement\n{\n\treturn Tag.render`\n\t\t<div class=\"counters-skeleton\">\n\t\t\t<div class=\"counters-skeleton__item\">\n\t\t\t\t<div class=\"counters-skeleton__item-text\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`;\n}\n\nfunction createRightButtons(count: number): HTMLElement\n{\n\tconst wrapper = Tag.render`<div class=\"actions-bar-skeleton__right-buttons\"></div>`;\n\n\tfor (let i = 0; i < count; i++)\n\t{\n\t\tconst button = Tag.render`\n\t\t\t<div class=\"actions-bar-skeleton__right-button\">\n\t\t\t\t<div class=\"actions-bar-skeleton__right-button-text\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(button, wrapper);\n\t}\n\n\treturn wrapper;\n}\n","import { Tag } from 'main.core';\n\nimport '../../css/skeletons/composite-grid-skeleton.css';\n\nexport const createGridSkeleton = (): HTMLElement => {\n\treturn Tag.render`\n\t\t<div class=\"grid-skeleton-container --ui-context-content-light\">\n\t\t\t<table class=\"grid-skeleton\">\n\t\t\t\t<thead>\n\t\t\t\t\t<tr class=\"grid-skeleton__header-row\">\n\t\t\t\t\t\t<th class=\"grid-skeleton__header-cell\">\n\t\t\t\t\t\t\t<div class=\"grid-skeleton__checkbox\"></div>\n\t\t\t\t\t\t</th>\n\t\t\t\t\t\t<th class=\"grid-skeleton__header-cell\">\n\t\t\t\t\t\t\t<div class=\"grid-skeleton__avatar\"></div>\n\t\t\t\t\t\t</th>\n\t\t\t\t\t\t<th class=\"grid-skeleton__header-cell\">\n\t\t\t\t\t\t\t<div class=\"grid-skeleton__cell-title --short\"></div>\n\t\t\t\t\t\t</th>\n\t\t\t\t\t\t<th class=\"grid-skeleton__header-cell\">\n\t\t\t\t\t\t\t<div class=\"grid-skeleton__cell-title\"></div>\n\t\t\t\t\t\t</th>\n\t\t\t\t\t\t<th class=\"grid-skeleton__header-cell\">\n\t\t\t\t\t\t\t<div class=\"grid-skeleton__cell-title\"></div>\n\t\t\t\t\t\t</th>\n\t\t\t\t\t\t<th class=\"grid-skeleton__header-cell\">\n\t\t\t\t\t\t\t<div class=\"grid-skeleton__cell-title\"></div>\n\t\t\t\t\t\t</th>\n\t\t\t\t\t\t<th class=\"grid-skeleton__header-cell\">\n\t\t\t\t\t\t\t<div class=\"grid-skeleton__cell-title\"></div>\n\t\t\t\t\t\t</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t${getGridSkeletonRows()}\n\t\t\t</table>\n\t\t</div>\n\t`;\n};\n\nfunction getGridSkeletonRows(): HTMLElement[]\n{\n\treturn Tag.render`\n\t\t<tbody>\n\t\t\t${createGridSkeletonRow()}\n\t\t\t${createGridSkeletonRow()}\n\t\t\t${createGridSkeletonRow()}\n\t\t\t${createGridSkeletonRow()}\n\t\t\t${createGridSkeletonRow()}\n\t\t\t${createGridSkeletonRow()}\n\t\t\t${createGridSkeletonRow()}\n\t\t</tbody>\n\t`;\n}\n\nfunction createGridSkeletonRow(): HTMLElement\n{\n\treturn Tag.render`\n\t\t<tr class=\"grid-skeleton__row\">\n\t\t\t<td class=\"grid-skeleton__cell\">\n\t\t\t\t<div class=\"grid-skeleton__checkbox\"></div>\n\t\t\t</td>\n\t\t\t<td class=\"grid-skeleton__cell\">\n\t\t\t\t<div class=\"grid-skeleton__avatar\"></div>\n\t\t\t</td>\n\t\t\t<td class=\"grid-skeleton__cell\">\n\t\t\t\t<div class=\"grid-skeleton__cell-two-text\">\n\t\t\t\t\t<div class=\"grid-skeleton__cell-title --long\"></div>\n\t\t\t\t\t<div class=\"grid-skeleton__cell-title --short\"></div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t\t<td class=\"grid-skeleton__cell\">\n\t\t\t\t<div class=\"grid-skeleton__cell-button\"></div>\n\t\t\t</td>\n\t\t\t<td class=\"grid-skeleton__cell\">\n\t\t\t\t<div class=\"grid-skeleton__avatar-title\">\n\t\t\t\t\t<div class=\"grid-skeleton__avatar\"></div>\n\t\t\t\t\t<div class=\"grid-skeleton__cell-title\"></div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t\t<td class=\"grid-skeleton__cell\">\n\t\t\t\t<div class=\"grid-skeleton__avatar-title\">\n\t\t\t\t\t<div class=\"grid-skeleton__avatar\"></div>\n\t\t\t\t\t<div class=\"grid-skeleton__cell-title\"></div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t\t<td class=\"grid-skeleton__cell\">\n\t\t\t\t<div class=\"grid-skeleton__avatar-title\">\n\t\t\t\t\t<div class=\"grid-skeleton__avatar\"></div>\n\t\t\t\t\t<div class=\"grid-skeleton__cell-title\"></div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t`;\n}\n","import { Tag } from 'main.core';\n\nimport '../../css/skeletons/composite-kanban-skeleton.css';\n\nexport const createKanbanSkeleton = (): HTMLElement => {\n\treturn Tag.render`\n\t\t<div class=\"kanban-skeleton --stage-right\">\n\t\t\t<div class=\"kanban-skeleton__col\">\n\t\t\t\t<div class=\"kanban-skeleton__col-stage\"></div>\n\t\t\t\t<div class=\"kanban-skeleton__col-tiles\">\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile --lg\"></div>\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"kanban-skeleton__col\">\n\t\t\t\t<div class=\"kanban-skeleton__col-stage\"></div>\n\t\t\t\t<div class=\"kanban-skeleton__col-tiles\">\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile\"></div>\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile --lg\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"kanban-skeleton__col\">\n\t\t\t\t<div class=\"kanban-skeleton__col-stage\"></div>\n\t\t\t\t<div class=\"kanban-skeleton__col-tiles\">\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile --lg\"></div>\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile --lg\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"kanban-skeleton__col\">\n\t\t\t\t<div class=\"kanban-skeleton__col-stage\"></div>\n\t\t\t\t<div class=\"kanban-skeleton__col-tiles\">\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile --lg\"></div>\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"kanban-skeleton__col\">\n\t\t\t\t<div class=\"kanban-skeleton__col-stage\"></div>\n\t\t\t\t<div class=\"kanban-skeleton__col-tiles\">\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile --lg\"></div>\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile --lg\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"kanban-skeleton__col\">\n\t\t\t\t<div class=\"kanban-skeleton__col-stage\"></div>\n\t\t\t\t<div class=\"kanban-skeleton__col-tiles\">\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile\"></div>\n\t\t\t\t\t<div class=\"kanban-skeleton__col-tile --lg\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`;\n};\n","import { Type, Tag, Dom, ajax as Ajax } from 'main.core';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { MemoryCache, type BaseCache } from 'main.core.cache';\nimport { PULL } from 'pull.client';\nimport { getBackUrl } from './helpers';\n\nimport { createToolbarSkeleton, type ToolbarSkeletonOptions } from './skeletons/create-toolbar-skeleton';\nimport { createActionsBarSkeleton, type ActionsBarSkeletonOptions } from './skeletons/create-actions-bar-skeleton';\nimport { createGridSkeleton } from './skeletons/create-grid-skeleton';\nimport { createKanbanSkeleton } from './skeletons/create-kanban-skeleton';\n\ntype GridSkeletonOptions = {\n\ttoolbarOptions?: ToolbarSkeletonOptions,\n\tactionsBarOptions?: ActionsBarSkeletonOptions | boolean;\n};\n\ntype KanbanSkeletonOptions = {\n\ttoolbarOptions?: ToolbarSkeletonOptions,\n\tactionsBarOptions?: ActionsBarSkeletonOptions | boolean;\n};\n\nexport class Composite\n{\n\t#refs: BaseCache<HTMLElement> = new MemoryCache();\n\n\tconstructor()\n\t{\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tthis.#bindEvents();\n\t\t}\n\t}\n\n\tisEnabled(): boolean\n\t{\n\t\treturn !Type.isUndefined(window.frameRequestStart);\n\t}\n\n\tisReady(): boolean\n\t{\n\t\treturn window.BX?.frameCache?.frameDataInserted === true || !Type.isUndefined(window.frameRequestFail);\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tif (this.isReady())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst page = window.location.pathname;\n\t\tif (page === '/stream/' || page === '/stream/index.php' || page === '/index.php')\n\t\t{\n\t\t\tthis.#showLoader(this.getLiveFeedSkeleton());\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst kanbanOptions = this.#getKanbanSkeletonOptions(page);\n\t\tif (kanbanOptions !== null)\n\t\t{\n\t\t\tthis.#showLoader(this.#createKanbanSkeleton(kanbanOptions));\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst gridOptions = this.#getGridSkeletonOptions(page);\n\t\tif (gridOptions !== null)\n\t\t{\n\t\t\tthis.#showLoader(this.#createGridSkeleton(gridOptions));\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#showLoader();\n\t}\n\n\t#showLoader(skeleton: HTMLElement = null): void\n\t{\n\t\tconst container = this.getStubContainer();\n\t\tconst stub = skeleton ?? this.getLoaderContainer();\n\t\tif (!container || stub.parentNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.append(stub, container);\n\t}\n\n\t#getGridSkeletonOptions(page: string): GridSkeletonOptions | null\n\t{\n\t\tconst patterns: Array<[RegExp, GridSkeletonOptions]> = [\n\t\t\t[/^\\/workgroups\\/$/, { actionsBarOptions: true }],\n\n\t\t\t[/^\\/crm\\/(lead|deal|quote)\\/(list|category)\\/.*?$/, { toolbarOptions: { showIconButton: true }, actionsBarOptions: { showCounterPanel: true, rightButtonsCount: 2 } }],\n\t\t\t[/^\\/crm\\/(contact|company)\\/list\\/.*?$/, { toolbarOptions: { showIconButton: true }, actionsBarOptions: { rightButtonsCount: 1 } }],\n\t\t\t[/^\\/crm\\/type\\/\\d+\\/list\\/.*?$/, { toolbarOptions: { showIconButton: true }, actionsBarOptions: { rightButtonsCount: 1 } }],\n\t\t\t[/^\\/crm\\/configs\\/mycompany\\/.*?$/, { toolbarOptions: { showIconButton: true } }],\n\t\t\t[/^\\/crm\\/(events|activity|webform|copilot-call-assessment|catalog)\\/.*?$/, {}],\n\t\t\t[/^\\/crm\\/type\\/$/, {}],\n\n\t\t\t[/^\\/company\\/$/, { toolbarOptions: { showIconButton: true }, actionsBarOptions: { rightButtonsCount: 1 } }],\n\t\t\t[/^\\/company\\/personal\\/user\\/\\d+\\/tasks\\/(projects|flow|scrum)\\/.*?$/, { actionsBarOptions: { rightButtonsCount: 2 } }],\n\t\t\t[/^\\/company\\/personal\\/user\\/\\d+\\/tasks\\/(departments|templates)\\/.*?$/, {}],\n\n\t\t\t[/^\\/sign\\/(list|contact)\\/.*?$/, { toolbarOptions: { showIconButton: true }, actionsBarOptions: { rightButtonsCount: 1 } }],\n\t\t\t[/^\\/sign\\/mysafe\\/.*?$/, {}],\n\t\t\t[/^\\/sign\\/b2e\\/list\\/.*?$/, { toolbarOptions: { showIconButton: true }, actionsBarOptions: { rightButtonsCount: 1 } }],\n\t\t\t[/^\\/sign\\/b2e\\/my-documents\\/.*?$/, { actionsBarOptions: true }],\n\t\t\t[/^\\/sign\\/b2e\\/(settings|member_dynamic_settings|signers)\\/.*?$/, {}],\n\n\t\t\t[/^\\/shop\\/documents\\/(contractors|contractors_contacts)\\/.*?$/, { toolbarOptions: { showIconButton: true }, actionsBarOptions: { rightButtonsCount: 1 } }],\n\t\t\t[/^\\/shop\\/documents\\/.*?$/, { toolbarOptions: { showIconButton: true } }],\n\t\t\t[/^\\/shop\\/catalog\\/\\d+\\/.*?$/, {}],\n\t\t\t[/^\\/shop\\/documents-catalog\\/.*?$/, {}],\n\t\t\t[/^\\/shop\\/orders\\/.*?$/, { toolbarOptions: { showIconButton: true }, actionsBarOptions: { rightButtonsCount: 1 } }],\n\t\t\t[/^\\/shop\\/settings\\/(sale_location_type_list|sale_location_node_list|sale_person_type|sale_transact_admin|sale_basket)\\/.*?$/, {}],\n\n\t\t\t[/^\\/company\\/lists\\/\\d+\\/view\\/\\d+\\/.*?$/, { toolbarOptions: { showIconButton: true } }],\n\t\t\t[/^\\/company\\/lists\\/\\d+\\/fields\\/.*?$/, { toolbarOptions: { showIconButton: true } }],\n\n\t\t\t[/^\\/automation\\/type\\/.*?$/, {}],\n\t\t\t[/^\\/bizproc\\/userprocesses\\/.*?$/, { actionsBarOptions: true }],\n\t\t\t[/^\\/bizproc\\/(start|bizproc)\\/.*?$/, {}],\n\t\t\t[/^\\/marketing\\/(letter|ads|segment|template|blacklist|contact|rc|toloka)\\/.*?$/, {}],\n\t\t\t[/^\\/conference\\/.*?$/, {}],\n\t\t\t[/^\\/bi\\/dashboard\\/.*?$/, {}],\n\t\t\t[/^\\/rpa\\/tasks\\/.*?$/, {}],\n\t\t];\n\n\t\tfor (const pattern of patterns)\n\t\t{\n\t\t\tif (pattern[0].test(page))\n\t\t\t{\n\t\t\t\treturn pattern[1];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#createKanbanSkeleton(options: KanbanSkeletonOptions): HTMLElement\n\t{\n\t\tconst actionsBarOptions = options?.actionsBarOptions ?? {};\n\t\tconst showActionsBar = Type.isObject(options?.actionsBarOptions) || options?.actionsBarOptions === true;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"grid-skeleton-wrapper\">\n\t\t\t\t${createToolbarSkeleton(options.toolbarOptions)}\n\t\t\t\t${showActionsBar ? createActionsBarSkeleton(actionsBarOptions) : null}\n\t\t\t\t${createKanbanSkeleton()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getKanbanSkeletonOptions(page: string): KanbanSkeletonOptions | null\n\t{\n\t\tconst patterns: Array<[RegExp, KanbanSkeletonOptions]> = [\n\t\t\t[/^\\/crm\\/(lead|deal)\\/(kanban|activity)\\/.*?$/, { toolbarOptions: { showIconButton: true }, actionsBarOptions: { rightButtonsCount: 2 } }],\n\t\t\t[/^\\/crm\\/type\\/\\d+\\/kanban\\/.*?$/, {}],\n\t\t\t[/^\\/sign\\/$/, { toolbarOptions: { showIconButton: true }, actionsBarOptions: { rightButtonsCount: 1 } }],\n\t\t\t[/^\\/sign\\/b2e\\/$/, { toolbarOptions: { showIconButton: true }, actionsBarOptions: { rightButtonsCount: 1 } }],\n\t\t];\n\n\t\tfor (const pattern of patterns)\n\t\t{\n\t\t\tif (pattern[0].test(page))\n\t\t\t{\n\t\t\t\treturn pattern[1];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#createGridSkeleton(options: GridSkeletonOptions): HTMLElement\n\t{\n\t\tconst actionsBarOptions = options?.actionsBarOptions ?? {};\n\t\tconst showActionsBar = Type.isObject(options?.actionsBarOptions) || options?.actionsBarOptions === true;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"grid-skeleton-wrapper\">\n\t\t\t\t${createToolbarSkeleton(options.toolbarOptions)}\n\t\t\t\t${showActionsBar ? createActionsBarSkeleton(actionsBarOptions) : null}\n\t\t\t\t${createGridSkeleton()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetStubContainer(): HTMLElement | null\n\t{\n\t\treturn document.querySelector('#page-area');\n\t}\n\n\tgetLoaderContainer(): HTMLElement\n\t{\n\t\treturn this.#refs.remember('loader', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"composite-skeleton-container\">\n\t\t\t\t\t<div class=\"composite-loader-container\">\n\t\t\t\t\t\t<svg class=\"composite-loader-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t\t\t\t<circle class=\"composite-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tEventEmitter.subscribe('onFrameDataRequestFail', () => {\n\t\t\tconsole.error('Composite ajax request failed');\n\t\t\ttop.location = `/auth/?backurl=${encodeURIComponent(getBackUrl())}`;\n\t\t});\n\n\t\tEventEmitter.subscribe('onAjaxFailure', (event: BaseEvent) => {\n\t\t\tconst [reason, status] = event.getCompatData();\n\t\t\tconst redirectUrl = `/auth/?backurl=${getBackUrl()}`;\n\t\t\tif (this.isEnabled() && (reason === 'auth' || (reason === 'status' && status === 401)))\n\t\t\t{\n\t\t\t\tconsole.error('Auth ajax request failed', reason, status);\n\t\t\t\ttop.location = redirectUrl;\n\t\t\t}\n\t\t});\n\n\t\tif (PULL)\n\t\t{\n\t\t\tPULL.subscribe({\n\t\t\t\tmoduleId: 'main',\n\t\t\t\tcommand: 'composite-cache-up',\n\t\t\t\tcallback: () => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tconst value = BX.localStorage.get('ajax-composite-cache-up-lock');\n\t\t\t\t\t\tif (!value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.localStorage.set('ajax-composite-cache-up-lock', 'EXECUTE', 2);\n\t\t\t\t\t\t\tAjax({\n\t\t\t\t\t\t\t\turl: '/blank.php',\n\t\t\t\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\t\t\t\tprocessData: false,\n\t\t\t\t\t\t\t\tskipBxHeader: true,\n\t\t\t\t\t\t\t\temulateOnload: false,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, Math.floor(Math.random() * 500));\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\n\tgetLiveFeedSkeleton(): HTMLElement\n\t{\n\t\treturn this.#refs.remember('feed-skeleton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"page top-menu-mode start-page no-background no-all-paddings no-page-header\">\n\t\t\t\t\t<div class=\"page__workarea\">\n\t\t\t\t\t\t<div class=\"page__sidebar\">${this.getLiveFeedSidebar()}</div>\n\t\t\t\t\t\t<main class=\"page__workarea-content\">${this.getLiveFeedWorkArea()}</main>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLiveFeedSidebar(): HTMLElement\n\t{\n\t\treturn this.#refs.remember('feed-sidebar', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"skeleton__white-bg-element skeleton__sidebar skeleton__intranet-ustat\">\n\t\t\t\t\t<div class=\"skeleton__graph-circle\"></div>\n\t\t\t\t\t<div class=\"skeleton__graph-right\">\n\t\t\t\t\t\t<div class=\"skeleton__graph-right_top\">\n\t\t\t\t\t\t\t<div class=\"skeleton__graph-right_top-circle --first\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__graph-right_top-circle\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__graph-right_top-circle\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__graph-right_top-circle\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__graph-right_top-circle\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__graph-right_top-circle\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__graph-right_top-circle\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"skeleton__graph-right_bottom\">\n\t\t\t\t\t\t\t<div class=\"skeleton__graph-right_bottom-line\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__graph-right_bottom-line\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"skeleton__white-bg-element skeleton__sidebar\">\n\t\t\t\t\t<div class=\"skeleton__sidebar-header\">\n\t\t\t\t\t\t<div class=\"skeleton__sidebar-header_line\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__sidebar-header_circle\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__tasks-row\">\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_line\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_short-line\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_circle\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__tasks-row\">\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_line\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_short-line\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_circle\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__tasks-row\">\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_line\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_short-line\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_circle\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__tasks-row\">\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_line\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_short-line\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__tasks-row_circle\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"skeleton__white-bg-element skeleton__sidebar\">\n\t\t\t\t\t<div class=\"skeleton__sidebar-header\">\n\t\t\t\t\t\t<div class=\"skeleton__sidebar-header_line\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__birthdays-row\">\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-circle\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-info\">\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-name\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-date\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__birthdays-row\">\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-circle\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-info\">\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-name\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-date\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__birthdays-row\">\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-circle\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-info\">\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-name\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-date\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__birthdays-row\">\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-circle\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-info\">\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-name\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-date\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"skeleton__white-bg-element skeleton__sidebar\">\n\t\t\t\t\t<div class=\"skeleton__sidebar-header\">\n\t\t\t\t\t\t<div class=\"skeleton__sidebar-header_line\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__birthdays-row\">\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-circle\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-info\">\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-name\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-date\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__birthdays-row\">\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-circle\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-info\">\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-name\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-date\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__birthdays-row\">\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-circle\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-info\">\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-name\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-date\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__birthdays-row\">\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-circle\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__birthdays-info\">\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-name\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__birthdays-date\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLiveFeedWorkArea(): HTMLElement\n\t{\n\t\treturn this.#refs.remember('feed-work-area', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"skeleton__white-bg-element skeleton__feed-wrap\">\n\t\t\t\t\t<div class=\"skeleton__feed-wrap_header\">\n\t\t\t\t\t\t<div class=\"skeleton__feed-wrap_header-link --long\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-wrap_header-link --one\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-wrap_header-link --two\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-wrap_header-link --one\"></div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-wrap_header-link --two\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"skeleton__feed-wrap_header-content\">\n\t\t\t\t\t\t<div class=\"skeleton__feed-wrap_header-text\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"skeleton__title-block\">\n\t\t\t\t\t<div class=\"skeleton__title-block_text\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"skeleton__white-bg-element skeleton__feed-item\">\n\t\t\t\t\t<div class=\"skeleton__feed-item_user-icon\"></div>\n\t\t\t\t\t<div class=\"skeleton__feed-item_content\">\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_main\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text --name\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_date\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text --short\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --one\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --two\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --three\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --four\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_like\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_like-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_like-name\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment-block\">\n\t\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment-text\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"skeleton__white-bg-element skeleton__feed-item\">\n\t\t\t\t\t<div class=\"skeleton__feed-item_user-icon\"></div>\n\t\t\t\t\t<div class=\"skeleton__feed-item_content\">\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_main\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text --name\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_date\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text --short\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --one\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --two\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --three\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --four\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_like\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_like-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_like-name\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment-block\">\n\t\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment-text\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"skeleton__white-bg-element skeleton__feed-item\">\n\t\t\t\t\t<div class=\"skeleton__feed-item_user-icon\"></div>\n\t\t\t\t\t<div class=\"skeleton__feed-item_content\">\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_main\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text --name\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_date\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_text --short\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --one\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --two\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --three\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_nav-line --four\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_like\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_like-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_like-name\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment\">\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment-block\">\n\t\t\t\t\t\t\t\t<div class=\"skeleton__feed-item_comment-text\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import { Event, Dom } from 'main.core';\nimport type { GoTopButton } from './go-top-button';\n\nexport type RightBarOptions = {\n\tgoTopButton: GoTopButton;\n};\n\nexport class RightBar\n{\n\t#isTransparentMode: boolean = false;\n\t#isScrollMode: boolean = false;\n\t#scrollModeThreshold: number = window.innerHeight;\n\t#goTopButton: GoTopButton;\n\n\tconstructor(options: RightBarOptions)\n\t{\n\t\tconst redraw = this.redraw.bind(this);\n\t\tEvent.bind(window, 'scroll', redraw, { passive: true });\n\t\tEvent.bind(window, 'resize', redraw);\n\t\tthis.#scrollModeThreshold = window.innerHeight;\n\t\tthis.#goTopButton = options.goTopButton;\n\n\t\tthis.#goTopButton.subscribe('show', () => {\n\t\t\tDom.addClass(this.getContainer(), '--show-scroll-btn');\n\t\t});\n\n\t\tthis.#goTopButton.subscribe('hide', () => {\n\t\t\tDom.removeClass(this.getContainer(), '--show-scroll-btn');\n\t\t});\n\n\t\tEvent.ready(() => {\n\t\t\tthis.redraw();\n\t\t});\n\t}\n\n\tredraw(): void\n\t{\n\t\tconst rightBar = this.getContainer();\n\n\t\tthis.#scrollModeThreshold = window.innerHeight;\n\n\t\tif (window.pageYOffset > this.#scrollModeThreshold)\n\t\t{\n\t\t\tif (!this.#isScrollMode)\n\t\t\t{\n\t\t\t\tDom.addClass(rightBar, '--scroll-mode');\n\t\t\t\tthis.#isScrollMode = true;\n\t\t\t}\n\t\t}\n\t\telse if (this.#isScrollMode)\n\t\t{\n\t\t\tDom.removeClass(rightBar, '--scroll-mode');\n\t\t\tthis.#isScrollMode = false;\n\t\t}\n\n\t\tif (!rightBar || rightBar.dataset.lockRedraw === 'true')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst scrollWidth = document.documentElement.scrollWidth - document.documentElement.clientWidth;\n\t\tif (scrollWidth > 0)\n\t\t{\n\t\t\tif (!this.#isTransparentMode)\n\t\t\t{\n\t\t\t\tDom.addClass(rightBar, '--transparent');\n\t\t\t\tthis.#isTransparentMode = true;\n\t\t\t}\n\t\t}\n\t\telse if (this.#isTransparentMode)\n\t\t{\n\t\t\tDom.removeClass(rightBar, '--transparent');\n\t\t\tthis.#isTransparentMode = false;\n\t\t}\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn document.getElementById('right-bar');\n\t}\n}\n","export class Header\n{\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn document.getElementById('header');\n\t}\n}\n","import { Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport class Footer\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('Kanban.Grid:onFixedModeStart', () => {\n\t\t\tthis.hide();\n\t\t});\n\t}\n\n\tshow(): void\n\t{\n\t\tDom.removeClass(this.getContainer(), 'hidden');\n\t}\n\n\thide(): void\n\t{\n\t\tDom.addClass(this.getContainer(), 'hidden');\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn document.getElementById('air-footer');\n\t}\n}\n","import { Dom, Event } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { ButtonIcon, ButtonManager } from 'ui.buttons';\n\nexport class GoTopButton extends EventEmitter\n{\n\t#lastScrollOffset = 0;\n\t#isReversed = false;\n\t#button: Button;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.setEventNamespace('GoTopButton');\n\t\tthis.#bindEvents();\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn Dom.hasClass(this.#getButtonWrapper(), '--show');\n\t}\n\n\t#show(): void\n\t{\n\t\tthis.emit('show');\n\t\tDom.addClass(this.#getButtonWrapper(), '--show');\n\t}\n\n\t#hide(): void\n\t{\n\t\tthis.emit('hide');\n\t\tDom.removeClass(this.#getButtonWrapper(), '--show');\n\t}\n\n\t#getButtonWrapper(): HTMLElement\n\t{\n\t\treturn document.getElementById('goTopButtonWrapper');\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tEvent.ready(() => {\n\t\t\tthis.#handleScroll();\n\n\t\t\tEvent.bind(window, 'scroll', () => {\n\t\t\t\tthis.#handleScroll();\n\t\t\t});\n\n\t\t\tEvent.bind(this.#getButtonWrapper(), 'click', () => {\n\t\t\t\tthis.#handleButtonClick();\n\t\t\t});\n\t\t});\n\t}\n\n\t#handleScroll(): boolean\n\t{\n\t\tif (window.pageYOffset > document.documentElement.clientHeight)\n\t\t{\n\t\t\tthis.#show();\n\n\t\t\tif (this.#isReversed)\n\t\t\t{\n\t\t\t\tthis.#setReversed(false);\n\t\t\t\tthis.#lastScrollOffset = 0;\n\t\t\t}\n\t\t}\n\t\telse if (this.#isReversed === false)\n\t\t{\n\t\t\tthis.#hide();\n\t\t}\n\t}\n\n\t#handleButtonClick(): void\n\t{\n\t\tif (this.#isReversed)\n\t\t{\n\t\t\tthis.#setReversed(false);\n\n\t\t\twindow.scrollTo({\n\t\t\t\ttop: this.#lastScrollOffset,\n\t\t\t\tbehavior: 'instant',\n\t\t\t});\n\n\t\t\tthis.#lastScrollOffset = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#setReversed(true);\n\t\t\tthis.#lastScrollOffset = window.pageYOffset;\n\n\t\t\twindow.scrollTo({\n\t\t\t\ttop: 0,\n\t\t\t\tbehavior: 'instant',\n\t\t\t});\n\t\t}\n\t}\n\n\t#setReversed(flag: boolean = true): void\n\t{\n\t\tthis.#isReversed = flag;\n\n\t\tif (this.#isReversed)\n\t\t{\n\t\t\tthis.#getButton().setIcon(ButtonIcon.ANGLE_DOWN);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#getButton().setIcon(ButtonIcon.ANGLE_UP);\n\t\t}\n\t}\n\n\t#getButton(): Button\n\t{\n\t\treturn this.#button || ButtonManager.createFromNode(document.getElementById('goTopButton'));\n\t}\n}\n","import { Reflection } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nexport class CollaborationMenu\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('onImUpdateCounterMessage', this.#handleCounterUpdate.bind(this));\n\t\tEventEmitter.subscribe('onCounterDecrement', this.#handleLiveFeedCounterDecrement.bind(this));\n\t}\n\n\tgetMenu(): typeof(BX.Main.interfaceButtons) | null\n\t{\n\t\t/**\n\t\t *\n\t\t * @type {BX.Main.interfaceButtonsManager}\n\t\t */\n\t\tconst menuManager = Reflection.getClass('BX.Main.interfaceButtonsManager');\n\t\tif (menuManager)\n\t\t{\n\t\t\treturn menuManager.getById('top_menu_id_collaboration');\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#handleCounterUpdate(event: BaseEvent): void\n\t{\n\t\tconst menu = this.getMenu();\n\t\tconst [counter] = event.getCompatData();\n\t\tmenu?.updateCounter('im-message', counter);\n\t}\n\n\t#handleLiveFeedCounterDecrement(event: BaseEvent): void\n\t{\n\t\tconst [decrement] = event.getCompatData();\n\t\tconst menu = this.getMenu();\n\t\tif (menu)\n\t\t{\n\t\t\tconst item = menu.getItemById('menu_live_feed');\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tconst itemData = menu.getItemData(item);\n\t\t\t\tconst { COUNTER, COUNTER_ID } = itemData;\n\n\t\t\t\tmenu?.updateCounter(COUNTER_ID, Math.max(0, COUNTER - decrement));\n\t\t\t}\n\t\t}\n\t}\n}\n","import { Type, Reflection, Runtime, Dom, Browser } from 'main.core';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { ChatMenu } from './chat-menu';\nimport { Composite } from './composite';\nimport { RightBar } from './right-bar';\nimport { Header } from './header/header';\nimport { Footer } from './footer';\nimport { GoTopButton } from './go-top-button';\nimport { CollaborationMenu } from './collaboration-menu';\n\nexport class SiteTemplate\n{\n\t#rightBar: RightBar = null;\n\t#header: Header = null;\n\t#footer: Footer = null;\n\t#composite: Composite = null;\n\t#chatMenu: ChatMenu = null;\n\t#goTopButton: GoTopButton = null;\n\t#collaborationMenu: CollaborationMenu = null;\n\n\tconstructor()\n\t{\n\t\tthis.#preventFromIframe();\n\n\t\tthis.#patchPopupMenu();\n\t\tthis.#patchRestAPI();\n\t\tthis.#patchJSClock();\n\n\t\tthis.#goTopButton = new GoTopButton();\n\t\tthis.#rightBar = new RightBar({\n\t\t\tgoTopButton: this.#goTopButton,\n\t\t});\n\t\tthis.#header = new Header();\n\t\tthis.#footer = new Footer();\n\t\tthis.#composite = new Composite();\n\t\tthis.#chatMenu = new ChatMenu();\n\t\tthis.#collaborationMenu = new CollaborationMenu();\n\n\t\tthis.#applyUserAgentRules();\n\t}\n\n\tgetRightBar(): RightBar\n\t{\n\t\treturn this.#rightBar;\n\t}\n\n\tgetHeader(): Header\n\t{\n\t\treturn this.#header;\n\t}\n\n\tgetFooter(): Footer\n\t{\n\t\treturn this.#footer;\n\t}\n\n\tgetComposite(): Composite\n\t{\n\t\treturn this.#composite;\n\t}\n\n\tgetChatMenu(): ChatMenu\n\t{\n\t\treturn this.#chatMenu;\n\t}\n\n\tgetCollaborationMenu(): CollaborationMenu\n\t{\n\t\treturn this.#collaborationMenu;\n\t}\n\n\t#patchPopupMenu(): void\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Menu:onInit', (event: BaseEvent) => {\n\t\t\tconst { params } = event.getData();\n\t\t\tif (params && Type.isNumber(params.maxWidth))\n\t\t\t{\n\t\t\t\t// We increased menu-item's font-size that's why we increase max-width\n\t\t\t\tparams.maxWidth += 10;\n\t\t\t}\n\t\t});\n\t}\n\n\t#patchJSClock(): void\n\t{\n\t\tEventEmitter.subscribe('onJCClockInit', (config) => {\n\t\t\twindow.JCClock.setOptions({\n\t\t\t\tcenterXInline: 83,\n\t\t\t\tcenterX: 83,\n\t\t\t\tcenterYInline: 67,\n\t\t\t\tcenterY: 79,\n\t\t\t\tminuteLength: 31,\n\t\t\t\thourLength: 26,\n\t\t\t\tpopupHeight: 229,\n\t\t\t\tinaccuracy: 15,\n\t\t\t\tcancelCheckClick: true,\n\t\t\t});\n\t\t});\n\t}\n\n\t#preventFromIframe(): void\n\t{\n\t\tconst iframeMode = window !== window.top;\n\t\tif (iframeMode)\n\t\t{\n\t\t\twindow.top.location = window.location.href;\n\t\t}\n\t}\n\n\t#applyUserAgentRules(): void\n\t{\n\t\tif (!Browser.isMobile() && document.referrer !== '' && document.referrer.startsWith(location.origin) === false)\n\t\t{\n\t\t\tRuntime.loadExtension('intranet.recognize-links');\n\t\t}\n\t}\n\n\t#patchRestAPI(): void\n\t{\n\t\tconst AppLayout = Reflection.getClass('BX.rest.AppLayout');\n\t\tif (!AppLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst placementInterface = AppLayout.initializePlacement('DEFAULT');\n\t\tplacementInterface.prototype.showHelper = async function(params, cb)\n\t\t{\n\t\t\tlet query = '';\n\t\t\tif (Type.isNumber(params))\n\t\t\t{\n\t\t\t\tquery = `redirect=detail&code=${params}`;\n\t\t\t}\n\t\t\telse if (Type.isStringFilled(params))\n\t\t\t{\n\t\t\t\tquery = params;\n\t\t\t}\n\t\t\telse if (Type.isPlainObject(params))\n\t\t\t{\n\t\t\t\tfor (const param of Object.keys(params))\n\t\t\t\t{\n\t\t\t\t\tif (query.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tquery += '&';\n\t\t\t\t\t}\n\n\t\t\t\t\tquery += `${param}=${params[param]}`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (query.length > 0)\n\t\t\t{\n\t\t\t\tawait Runtime.loadExtension('helper');\n\t\t\t\tconst Helper = Reflection.getClass('BX.Helper');\n\t\t\t\tHelper.show(query);\n\t\t\t}\n\t\t};\n\t}\n}\n","import { Event, Runtime, Dom, Type, Reflection, type JsonObject } from 'main.core';\n\nexport class SearchTitle\n{\n\t#searchOptions: JsonObject = {};\n\t#extensionLoaded: boolean = false;\n\t#container: HTMLElement = null;\n\t#button: HTMLElement = null;\n\t#input: HTMLInputElement = null;\n\t#searchTitleInstance = null;\n\n\tconstructor(options)\n\t{\n\t\tthis.#container = document.getElementById(options.containerId);\n\t\tthis.#button = document.getElementById(options.buttonId);\n\t\tthis.#input = document.getElementById(options.inputId);\n\n\t\tthis.#searchOptions = options.searchOptions;\n\n\t\tEvent.bind(this.#button, 'click', this.#handleButtonClick.bind(this));\n\t\tEvent.bind(this.#input, 'focusout', this.#handleInputFocusOut.bind(this));\n\t}\n\n\topen(): void\n\t{\n\t\tDom.addClass(this.#container, '--active');\n\n\t\tthis.#input.disabled = false;\n\n\t\tsetTimeout(() => {\n\t\t\tthis.#input.focus();\n\t\t}, 200);\n\t}\n\n\tclose(): void\n\t{\n\t\tDom.removeClass(this.#container, '--active');\n\t\tthis.#input.disabled = true;\n\n\t\tif (this.#searchTitleInstance !== null)\n\t\t{\n\t\t\tthis.#searchTitleInstance.clearSearch();\n\t\t\tthis.#searchTitleInstance.closeResult();\n\t\t}\n\t}\n\n\t#handleButtonClick(): void\n\t{\n\t\tif (Dom.hasClass(this.#container, '--active'))\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\tif (this.#extensionLoaded)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#extensionLoaded = true;\n\t\tRuntime.loadExtension('intranet.search_title').then(() => {\n\t\t\tconst SearchTitleClass = Reflection.getClass('BX.Intranet.SearchTitle');\n\t\t\tthis.#searchTitleInstance = new SearchTitleClass(this.#searchOptions);\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t}\n\n\t#handleInputFocusOut(event): void\n\t{\n\t\tif (!Type.isStringFilled(this.#input.value) && event.relatedTarget !== this.#button)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t}\n}\n","import { Event, Runtime, Type, ajax, Dom, Tag } from 'main.core';\nimport { BaseCache, MemoryCache } from 'main.core.cache';\nimport { EventEmitter } from 'main.core.events';\nimport { SidePanel } from 'main.sidepanel';\nimport { Counter, CounterStyle } from 'ui.cnt';\nimport { WidgetLoader } from 'intranet.widget-loader';\nimport { AvatarWidget } from 'intranet.avatar-widget';\nimport { PULL } from 'pull.client';\nimport { WorkTimeStateIcon } from 'timeman.work-time-state-icon';\n\ntype AvatarButtonOptions = {\n\tuserId: number,\n\tskeleton: Object,\n\tsignDocumentsCounter: number,\n\tsignDocumentsPullEventName: string,\n\tworkTimeAvailable: boolean,\n\tworkTimeState: string,\n\tworkTimeAction: string,\n\tisAmPmMode: boolean,\n}\n\nexport class AvatarButton\n{\n\tstatic #avatarWrapper: HTMLElement;\n\tstatic #cache: BaseCache<any> = new MemoryCache();\n\tstatic #options: AvatarButtonOptions;\n\n\tstatic init(options: AvatarButtonOptions): void\n\t{\n\t\tthis.#options = options;\n\t\tthis.#avatarWrapper = document.querySelector('[data-id=\"bx-avatar-widget\"]');\n\t\tthis.#setEventHandlerForChangeAvatar();\n\t\tthis.#setEventHandlerForScroll();\n\t\tthis.#startClock();\n\n\t\tif (this.#options.signDocumentsCounter > 0)\n\t\t{\n\t\t\tthis.#showCounter();\n\t\t\tthis.#setEventHandlerForUpdateCounter();\n\t\t}\n\n\t\tif (this.#options.workTimeAvailable)\n\t\t{\n\t\t\tthis.#showWorkTimeState();\n\t\t}\n\n\t\tEvent.bind(this.#avatarWrapper, 'click', () => {\n\t\t\tEvent.unbindAll(this.#avatarWrapper);\n\t\t\tthis.#getWidgetLoader().getPopup().setFixed(true);\n\t\t\tthis.#getWidgetLoader()\n\t\t\t\t.createSkeletonFromConfig(options.skeleton)\n\t\t\t\t.show();\n\t\t\tthis.#setHiddenAvatar();\n\t\t\tthis.#getWidgetLoader().getPopup().subscribe('onClose', () => {\n\t\t\t\tthis.#setVisibleAvatar();\n\t\t\t});\n\t\t\tthis.#getWidgetLoader().getPopup().subscribe('onShow', () => {\n\t\t\t\tthis.#setHiddenAvatar();\n\t\t\t});\n\t\t\tRuntime.loadExtension(['intranet.avatar-widget']).then(() => {\n\t\t\t\tthis.#showWidget();\n\t\t\t}).catch(() => {});\n\t\t});\n\t}\n\n\tstatic #showWidget(): void\n\t{\n\t\tthis.#getContent().then((response) => {\n\t\t\tthis.#getWidgetLoader().clearBeforeInsertContent();\n\t\t\tAvatarWidget.getInstance().setOptions({\n\t\t\t\tbuttonWrapper: this.#avatarWrapper,\n\t\t\t\tloader: this.#getWidgetLoader().getPopup(),\n\t\t\t\tdata: response.data,\n\t\t\t}).show();\n\t\t\tEvent.bind(this.#avatarWrapper, 'click', () => {\n\t\t\t\tAvatarWidget.getInstance().show();\n\t\t\t});\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t}\n\n\tstatic #getWidgetLoader(): WidgetLoader\n\t{\n\t\treturn this.#cache.remember('widgetLoader', () => {\n\t\t\treturn new WidgetLoader({\n\t\t\t\tid: 'bx-avatar-header-popup',\n\t\t\t\tbindElement: this.#avatarWrapper,\n\t\t\t\tclassName: 'intranet-avatar-widget-base-popup',\n\t\t\t\twidth: 390,\n\t\t\t\tuseAngle: false,\n\t\t\t\tfixed: true,\n\t\t\t\toffsetTop: -50,\n\t\t\t\toffsetLeft: 0,\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #getContent(): Promise\n\t{\n\t\treturn this.#cache.remember('content', () => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tajax.runAction('intranet.user.widget.getContent')\n\t\t\t\t\t.then((response) => resolve(response))\n\t\t\t\t\t.catch((response) => reject(response))\n\t\t\t\t;\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #showCounter(): void\n\t{\n\t\tthis.#getCounter().renderTo(this.#getCounterWrapper());\n\t}\n\n\tstatic #setHiddenAvatar(): void\n\t{\n\t\tDom.style(this.#avatarWrapper, 'opacity', '0');\n\t}\n\n\tstatic #setVisibleAvatar(): void\n\t{\n\t\tDom.style(this.#avatarWrapper, 'opacity', '1');\n\t}\n\n\tstatic #showWorkTimeState(): void\n\t{\n\t\tthis.#getWorkTimeState().renderTo(this.#getShortWorkTimeStateWrapper());\n\t\tthis.#getWorkTimeState().subscribe('onUpdateState', (event) => {\n\t\t\tthis.#updateStateButton(event.data);\n\t\t});\n\t}\n\n\tstatic #updateStateButton(config: { action: string, state: string }): void\n\t{\n\t\tlet className = '';\n\t\tconst stateClasses = [\n\t\t\t'--worktime-not-started',\n\t\t\t'--worktime-finished',\n\t\t\t'--worktime-not-finished',\n\t\t\t'--worktime-paused',\n\t\t];\n\n\t\tstateClasses.forEach((stateClass) => {\n\t\t\tDom.removeClass(this.#avatarWrapper, stateClass);\n\t\t});\n\n\t\tswitch (config.state)\n\t\t{\n\t\t\tcase 'CLOSED':\n\t\t\t\tclassName = config.action === 'OPEN'\n\t\t\t\t\t? '--worktime-not-started'\n\t\t\t\t\t: '--worktime-finished';\n\t\t\t\tbreak;\n\t\t\tcase 'EXPIRED':\n\t\t\t\tclassName = '--worktime-not-finished';\n\t\t\t\tbreak;\n\t\t\tcase 'PAUSED':\n\t\t\t\tclassName = '--worktime-paused';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tclassName = '';\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (className)\n\t\t{\n\t\t\tDom.addClass(this.#avatarWrapper, className);\n\t\t}\n\t}\n\n\tstatic #getCounterWrapper(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('counterWrapper', () => {\n\t\t\treturn this.#avatarWrapper.querySelector('.air-user-profile-avatar__counter');\n\t\t});\n\t}\n\n\tstatic #getShortWorkTimeStateWrapper(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('workTimeStateWrapper', () => {\n\t\t\treturn this.#avatarWrapper.querySelector('.air-user-profile-avatar__work-time-state-short');\n\t\t});\n\t}\n\n\tstatic #getCounter(): Counter\n\t{\n\t\treturn this.#cache.remember('counter', () => {\n\t\t\treturn new Counter({\n\t\t\t\tcolor: Counter.Color.DANGER,\n\t\t\t\tsize: Counter.Size.MEDIUM,\n\t\t\t\tvalue: this.#options.signDocumentsCounter,\n\t\t\t\tuseAirDesign: true,\n\t\t\t\tstyle: CounterStyle.FILLED_ALERT,\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #getWorkTimeState(): WorkTimeStateIcon\n\t{\n\t\treturn this.#cache.remember('workTimeState', () => {\n\t\t\treturn new WorkTimeStateIcon({\n\t\t\t\tstate: this.#options.workTimeState,\n\t\t\t\taction: this.#options.workTimeAction,\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #setEventHandlerForUpdateCounter(): void\n\t{\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'sign',\n\t\t\tcommand: this.#options.signDocumentsPullEventName,\n\t\t\tcallback: (params) => {\n\t\t\t\tif (!Type.isNumber(params?.needActionCount))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (params?.needActionCount > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.#getCounter().update(params.needActionCount);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.#getCounter().destroy();\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\tstatic #setEventHandlerForChangeAvatar(): void\n\t{\n\t\tconst avatar = this.#avatarWrapper.querySelector('.air-user-profile__avatar i');\n\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Intranet.UserProfile:Avatar:changed',\n\t\t\t(event) => {\n\t\t\t\tconst data = event.getData()[0];\n\t\t\t\tconst url = data && data.url ? data.url : '';\n\t\t\t\tconst eventUserId = data && data.userId ? data.userId : 0;\n\n\t\t\t\tif (this.#options.userId === eventUserId && avatar)\n\t\t\t\t{\n\t\t\t\t\tavatar.style = Type.isStringFilled(url)\n\t\t\t\t\t\t? `background-size: cover; background-image: url('${encodeURI(url)}')`\n\t\t\t\t\t\t: ''\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\t}\n\n\tstatic #setEventHandlerForScroll(): void\n\t{\n\t\tconst handleScroll = () => {\n\t\t\tif (window.scrollY > 20 && !Dom.hasClass(this.#avatarWrapper, '--collapsed'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.#avatarWrapper, '--collapsed');\n\t\t\t}\n\t\t\telse if (window.scrollY <= 20)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.#avatarWrapper, '--collapsed');\n\t\t\t}\n\t\t};\n\t\tEvent.bind(window, 'scroll', handleScroll);\n\t\tEventEmitter.subscribe('SidePanel.Slider:onOpen', () => {\n\t\t\tif (!Dom.hasClass(this.#avatarWrapper, '--collapsed'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.#avatarWrapper, '--collapsed');\n\t\t\t}\n\t\t});\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseComplete', () => {\n\t\t\tif (SidePanel.Instance.getOpenSlidersCount() === 0)\n\t\t\t{\n\t\t\t\thandleScroll();\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic #startClock(): void\n\t{\n\t\tconst timeNode = document.querySelector('.air-user-profile-avatar__time');\n\t\tif (!timeNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst updateClock = () => {\n\t\t\tconst now = new Date();\n\t\t\ttimeNode.innerHTML = this.#formatTime(now, this.#options.isAmPmMode);\n\t\t};\n\n\t\tupdateClock();\n\t\tsetInterval(updateClock, 1000);\n\t}\n\n\tstatic #formatTime(date, isAmPmMode): string\n\t{\n\t\tlet hours = date.getHours();\n\t\tconst minutes = String(date.getMinutes()).padStart(2, '0');\n\t\tlet ampm = '';\n\n\t\tif (isAmPmMode)\n\t\t{\n\t\t\tampm = hours >= 12 ? 'PM' : 'AM';\n\t\t\tconst meridiem = `<span class=\"air-user-profile-avatar__time-meridiem\">${ampm}</span>`;\n\t\t\thours %= 12;\n\t\t\thours = hours || 12;\n\n\t\t\treturn `${hours}:${minutes} ${meridiem}`;\n\t\t}\n\n\t\tconst formattedHours = String(hours).padStart(2, '0');\n\n\t\treturn `${formattedHours}:${minutes}`;\n\t}\n}\n","import { ajax, Event, Runtime } from 'main.core';\nimport { BaseCache, MemoryCache } from 'main.core.cache';\nimport { LicenseWidget as Bitrix24LicenseWidget } from 'bitrix24.license-widget';\nimport { LicenseWidget as IntranetLicenseWidget } from 'intranet.license-widget';\nimport { WidgetLoader } from 'intranet.widget-loader';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport {Counter, CounterColor, CounterStyle} from 'ui.cnt';\nimport { PULL } from 'pull.client';\n\ntype LicenseButtonOptions = {\n\tordersAwaitingPayment: number,\n\tskeleton: Object,\n\tisSidePanelDemoLicense: boolean,\n\tisAdmin: boolean,\n\tisCloud: boolean,\n\tinfrastructureForm: {\n\t\tid: string,\n\t\tsecCode: string,\n\t},\n};\n\nexport class LicenseButton\n{\n\tstatic #options: LicenseButtonOptions;\n\tstatic #buttonWrapper: HTMLElement;\n\tstatic #cache: BaseCache<any> = new MemoryCache();\n\n\tstatic init(options: LicenseButtonOptions): void\n\t{\n\t\tthis.#options = options;\n\t\tthis.#buttonWrapper = document.querySelector('[data-id=\"licenseWidgetWrapper\"]');\n\t\tthis.#setEventHandlers();\n\n\t\tif (this.#options.isCloud && this.#options.ordersAwaitingPayment > 0)\n\t\t{\n\t\t\tthis.#setCounterValue(this.#options.ordersAwaitingPayment);\n\t\t}\n\n\t\tEvent.bind(this.#buttonWrapper, 'click', () => {\n\t\t\tEvent.unbindAll(this.#buttonWrapper);\n\t\t\tthis.#getWidgetLoader()\n\t\t\t\t.createSkeletonFromConfig(options.skeleton)\n\t\t\t\t.show();\n\t\t\tRuntime.loadExtension([this.#getExtensionWidgetName()]).then(() => {\n\t\t\t\tthis.#showWidget();\n\t\t\t}).catch(() => {});\n\t\t});\n\t}\n\n\tstatic #getExtensionWidgetName(): string\n\t{\n\t\tif (this.#options.isCloud)\n\t\t{\n\t\t\treturn 'bitrix24.license-widget';\n\t\t}\n\n\t\treturn 'intranet.license-widget';\n\t}\n\n\tstatic #showWidget(): void\n\t{\n\t\tthis.#getContent().then((response) => {\n\t\t\tthis.#getWidgetLoader().clearBeforeInsertContent();\n\t\t\tlet licenseData = null;\n\n\t\t\tif (this.#options.isCloud)\n\t\t\t{\n\t\t\t\tlicenseData = response.data;\n\t\t\t\tlicenseData.loader = this.#getWidgetLoader().getPopup();\n\t\t\t\tlicenseData.wrapper = this.#buttonWrapper;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlicenseData = {\n\t\t\t\t\tloader: this.#getWidgetLoader().getPopup(),\n\t\t\t\t\tbuttonWrapper: this.#buttonWrapper,\n\t\t\t\t\tdata: response.data,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tthis.#getWidget().setOptions(licenseData).show();\n\t\t\tEvent.bind(this.#buttonWrapper, 'click', () => {\n\t\t\t\tthis.#getWidget().show();\n\t\t\t});\n\t\t}).catch(() => {});\n\t}\n\n\tstatic #getWidget(): IntranetLicenseWidget | Bitrix24LicenseWidget\n\t{\n\t\treturn this.#cache.remember('widget', () => {\n\t\t\tif (this.#options.isCloud)\n\t\t\t{\n\t\t\t\treturn Bitrix24LicenseWidget.getInstance();\n\t\t\t}\n\n\t\t\treturn IntranetLicenseWidget.getInstance();\n\t\t});\n\t}\n\n\tstatic #getWidgetLoader(): WidgetLoader\n\t{\n\t\treturn this.#cache.remember('widgetLoader', () => {\n\t\t\treturn new WidgetLoader({\n\t\t\t\tbindElement: this.#buttonWrapper,\n\t\t\t\twidth: 374,\n\t\t\t\tid: 'bx-license-header-popup',\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #getContent(): Promise\n\t{\n\t\treturn this.#cache.remember('content', () => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tif (this.#options.isCloud)\n\t\t\t\t{\n\t\t\t\t\tajax.runComponentAction('bitrix:bitrix24.license.widget', 'getData', {\n\t\t\t\t\t\tmode: 'class',\n\t\t\t\t\t})\n\t\t\t\t\t\t.then((response) => resolve(response))\n\t\t\t\t\t\t.catch((response) => reject(response))\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tajax.runAction('intranet.license.widget.getContent')\n\t\t\t\t\t\t.then((response) => resolve(response))\n\t\t\t\t\t\t.catch((response) => reject(response))\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #getCounter(): Counter\n\t{\n\t\treturn this.#cache.remember('counter', () => {\n\t\t\treturn new Counter({\n\t\t\t\tcolor: CounterColor.DANGER,\n\t\t\t\tuseAirDesign: true,\n\t\t\t\tstyle: CounterStyle.FILLED_ALERT,\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #getCounterWrapper(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('counter-wrapper', () => {\n\t\t\treturn this.#buttonWrapper.querySelector('.air-header-button__counter');\n\t\t});\n\t}\n\n\tstatic #setCounterValue(value: number): void\n\t{\n\t\tif (value < 1)\n\t\t{\n\t\t\tthis.#getCounter().destroy();\n\t\t\tthis.#cache.delete('counter');\n\t\t}\n\n\t\tif (value > 0 && this.#getCounterWrapper())\n\t\t{\n\t\t\tthis.#getCounter().update(value);\n\t\t\tthis.#getCounter().renderTo(this.#getCounterWrapper());\n\t\t}\n\t}\n\n\tstatic #setEventHandlers(): void\n\t{\n\t\tif (this.#options.isCloud && this.#options.isSidePanelDemoLicense)\n\t\t{\n\t\t\tBX.SidePanel.Instance.bindAnchors({\n\t\t\t\trules: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcondition: [\n\t\t\t\t\t\t\t/\\/settings\\/license_demo.php/,\n\t\t\t\t\t\t],\n\t\t\t\t\t\thandler(event)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tFeaturePromotersRegistry.getPromoter({ code: 'limit_demo' }).show();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t}\n\n\t\tif (this.#options.isCloud && this.#options.isAdmin)\n\t\t{\n\t\t\tPULL.subscribe({\n\t\t\t\tmoduleId: 'bitrix24',\n\t\t\t\tcommand: 'updateCountOrdersAwaitingPayment',\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tEventEmitter.emit('BX.Bitrix24.Orders:updateOrdersAwaitingPayment', new BaseEvent({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tcounter: Number(params.count),\n\t\t\t\t\t\t},\n\t\t\t\t\t}));\n\n\t\t\t\t\tif (params.count > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#setCounterValue(Number(params.count));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'Bitrix24InfrastructureSlider:show', this.#showInfrastructureSlider.bind(this));\n\t\t}\n\t}\n\n\tstatic #showInfrastructureSlider(): void\n\t{\n\t\tconst params = this.#options.infrastructureForm;\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\t'bx-infrastructure-slider',\n\t\t\t{\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn `<script data-b24-form=\"inline/${params.id}/${params.secCode}\" data-skip-moving=\"true\"></script>`;\n\t\t\t\t},\n\t\t\t\twidth: 664,\n\t\t\t\tloader: 'default-loader',\n\t\t\t\tcacheable: false,\n\t\t\t\tcloseByEsc: false,\n\t\t\t\tdata: { rightBoundary: 0 },\n\t\t\t\tevents: {\n\t\t\t\t\tonOpen: () => {\n\t\t\t\t\t\t(function(w, d, u) {\n\t\t\t\t\t\t\tconst s = d.createElement('script');\n\t\t\t\t\t\t\ts.async = true;\n\t\t\t\t\t\t\ts.src = `${u}?${Date.now() / 180_000 | 0}`;\n\t\t\t\t\t\t\tconst h = d.getElementsByTagName('script')[0];\n\t\t\t\t\t\t\th.parentNode.insertBefore(s, h);\n\t\t\t\t\t\t})(window, document, `https://bitrix24.team/upload/crm/form/loader_${params.id}_${params.secCode}.js`);\n\t\t\t\t\t},\n\t\t\t\t\tonOpenComplete: () => {\n\t\t\t\t\t\ttop.addEventListener('b24:form:send:success', (event) => {\n\t\t\t\t\t\t\tif (event.detail.object.identification.id === params.id)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tajax.runComponentAction('bitrix:bitrix24.license.widget', 'setOptionWaitingInfrastructure', {\n\t\t\t\t\t\t\t\t\tmode: 'class',\n\t\t\t\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t}\n}\n","import { BaseCache, MemoryCache } from 'main.core.cache';\nimport { ajax, Event, Runtime, Type, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { WidgetLoader } from 'intranet.widget-loader';\nimport { InvitationWidget } from 'intranet.invitation-widget';\nimport {Counter, CounterStyle} from 'ui.cnt';\n\ntype InvitationButtonOptions = {\n\tskeleton: Object,\n\tcounterId: string,\n\tinvitationCounter: number,\n\tshouldShowStructureCounter: boolean,\n};\n\nexport class InvitationButton\n{\n\tstatic #buttonWrapper: HTMLElement;\n\tstatic #cache: BaseCache<any> = new MemoryCache();\n\tstatic #options: InvitationButtonOptions;\n\n\tstatic init(options: InvitationButtonOptions): void\n\t{\n\t\tthis.#options = options;\n\t\tthis.#buttonWrapper = document.querySelector('[data-id=\"invitationButton\"]');\n\n\t\tEvent.bind(this.#buttonWrapper, 'click', () => {\n\t\t\tEvent.unbindAll(this.#buttonWrapper);\n\t\t\tthis.#getWidgetLoader()\n\t\t\t\t.createSkeletonFromConfig(options.skeleton)\n\t\t\t\t.show();\n\t\t\tRuntime.loadExtension(['intranet.invitation-widget']).then(() => {\n\t\t\t\tthis.#showWidget();\n\t\t\t}).catch(() => {});\n\t\t});\n\n\t\tif (this.#options.invitationCounter > 0)\n\t\t{\n\t\t\tthis.#getCounter().renderTo(this.#getCounterWrapper());\n\t\t}\n\n\t\tthis.#setEventHandlers();\n\t}\n\n\tstatic #showWidget(): void\n\t{\n\t\tthis.#getContent().then((response) => {\n\t\t\tthis.#getWidgetLoader().clearBeforeInsertContent();\n\t\t\tInvitationWidget.getInstance().setOptions({\n\t\t\t\tbuttonWrapper: this.#buttonWrapper,\n\t\t\t\tloader: this.#getWidgetLoader().getPopup(),\n\t\t\t\t...response.data,\n\t\t\t}).show();\n\t\t\tEvent.bind(this.#buttonWrapper, 'click', () => {\n\t\t\t\tInvitationWidget.getInstance().show();\n\t\t\t});\n\t\t}).catch(() => {});\n\t}\n\n\tstatic #getWidgetLoader(): WidgetLoader\n\t{\n\t\treturn this.#cache.remember('widgetLoader', () => {\n\t\t\treturn new WidgetLoader({\n\t\t\t\tbindElement: this.#buttonWrapper,\n\t\t\t\twidth: 350,\n\t\t\t\tid: 'bx-invitation-header-popup',\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #getContent(): Promise\n\t{\n\t\treturn this.#cache.remember('content', () => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tajax.runAction('intranet.invitationwidget.getData', {\n\t\t\t\t\tdata: {},\n\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\theaderPopup: 'Y',\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t\t.then((response) => resolve(response))\n\t\t\t\t\t.catch((response) => reject(response))\n\t\t\t\t;\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #setEventHandlers(): void\n\t{\n\t\tEventEmitter.subscribeOnce('HR.company-structure:first-popup-showed', this.#onFirstWatchNewStructure.bind(this));\n\t\tEventEmitter.subscribe('onPullEvent-main', (event) => {\n\t\t\tconst [command, params] = event.getCompatData();\n\n\t\t\tif (command === 'user_counter' && params[Loc.getMessage('SITE_ID')])\n\t\t\t{\n\t\t\t\tconst value = params[Loc.getMessage('SITE_ID')][this.#options.counterId];\n\n\t\t\t\tif (value > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.#onReceiveCounterValue(value);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic #onReceiveCounterValue(value): void\n\t{\n\t\tif (this.#options.shouldShowStructureCounter)\n\t\t{\n\t\t\tvalue++;\n\t\t}\n\n\t\tthis.#getCounter().update(value);\n\t\tthis.#options.invitationCounter = value;\n\n\t\tif (value > 0)\n\t\t{\n\t\t\tthis.#getCounter().renderTo(this.#getCounterWrapper());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#getCounter().destroy();\n\t\t\tthis.#cache.delete('counter');\n\t\t}\n\t}\n\n\tstatic #getCounterWrapper(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('counter-wrapper', () => {\n\t\t\treturn this.#buttonWrapper.querySelector('.invitation-widget-counter');\n\t\t});\n\t}\n\n\tstatic #getCounter(): Counter\n\t{\n\t\treturn this.#cache.remember('counter', () => {\n\t\t\treturn new Counter({\n\t\t\t\tvalue: this.#getCounterValue(),\n\t\t\t\tcolor: Counter.Color.DANGER,\n\t\t\t\tuseAirDesign: true,\n\t\t\t\tstyle: CounterStyle.FILLED_ALERT,\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #getCounterValue(): number\n\t{\n\t\tlet counterValue = Number(this.#options.invitationCounter);\n\t\tif (this.#options.shouldShowStructureCounter ?? false)\n\t\t{\n\t\t\tcounterValue++;\n\t\t}\n\n\t\treturn counterValue;\n\t}\n\n\tstatic #onFirstWatchNewStructure(): void\n\t{\n\t\tlet value = this.#getCounter().value;\n\n\t\tif (!Type.isNumber(value))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#options.shouldShowStructureCounter)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvalue--;\n\t\tthis.#options.shouldShowStructureCounter = false;\n\t\tthis.#getCounter().update(value);\n\t\tthis.#options.invitationCounter = value;\n\n\t\tif (value > 0)\n\t\t{\n\t\t\tthis.#getCounter().renderTo(this.#getCounterWrapper());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#getCounter().destroy();\n\t\t\tthis.#cache.delete('counter');\n\t\t}\n\t}\n}\n","import { Tag, Dom, Event, Runtime } from 'main.core';\nimport { type Popup as PopupInstance, type PopupOptions } from 'main.popup';\n\nimport { getBackUrl } from './helpers';\n\nimport '../css/language-switcher.css';\n\ntype LanguageList = {\n\t[languageCode: string]: LanguageListItem[];\n}\n\ntype LanguageListItem = {\n\tNAME: string;\n\tIS_BETA: boolean;\n};\n\nexport class LanguageSwitcher\n{\n\t#popup: ?PopupInstance;\n\n\tasync showLanguageListPopup(bindElement: HTMLElement, languages: LanguageList): void\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tawait this.#initPopup(bindElement, languages);\n\t\t}\n\n\t\tif (this.#popup.isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#popup.show();\n\t}\n\n\tasync #initPopup(bindElement: HTMLElement, languages: LanguageList): PopupInstance\n\t{\n\t\tconst windowScrollHandler = () => {\n\t\t\tthis.hideLanguageListPopup();\n\t\t};\n\n\t\tconst { Popup } = await Runtime.loadExtension('main.popup');\n\n\t\tconst popupOptions: PopupOptions = {\n\t\t\tbindElement,\n\t\t\tautoHide: true,\n\t\t\tcloseByEcs: true,\n\t\t\tcachable: false,\n\t\t\tcontent: this.#renderPopupContent(languages),\n\t\t\tevents: {\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tEvent.unbind(window, 'scroll', windowScrollHandler);\n\t\t\t\t\tthis.#popup.destroy();\n\t\t\t\t\tthis.#popup = null;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tthis.#popup = new Popup(popupOptions);\n\n\t\tEvent.bind(window, 'scroll', windowScrollHandler);\n\t}\n\n\thideLanguageListPopup(): void\n\t{\n\t\tthis.#popup?.close();\n\t}\n\n\tswitchPortalLanguage(languageCode: string): void\n\t{\n\t\twindow.location.href = `/auth/?user_lang=${languageCode}&backurl=${getBackUrl()}`;\n\t}\n\n\t#renderPopupContent(languages: LanguageList): HTMLElement\n\t{\n\t\tconst container = Tag.render`<div class=\"intranet__language-popup_list\"></div>`;\n\n\t\tObject.entries(languages).forEach(([languageCode: string, languageItem: LanguageListItem]) => {\n\t\t\tconst languageItemElement = Tag.render`\n\t\t\t\t<div class=\"intranet__language-popup_language-item\">\n\t\t\t\t\t<span class=\"intranet__language-popup_language-item-name\">${languageItem.NAME}</span>\n\t\t\t\t\t<span class=\"intranet__language-popup_language-beta\">${languageItem.IS_BETA ? ', beta' : ''}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(languageItemElement, 'click', () => {\n\t\t\t\tthis.switchPortalLanguage(languageCode);\n\t\t\t});\n\n\t\t\tDom.append(languageItemElement, container);\n\t\t});\n\n\t\treturn container;\n\t}\n}\n\nexport const languageSwitcher = new LanguageSwitcher();\n","import { Reflection } from 'main.core';\nimport { PartnerForm } from './js/partner-form/partner-form';\nimport { SiteTemplate } from './js/site-template';\nimport { SearchTitle } from './js/header/search-title';\nimport { AvatarButton } from './js/header/avatar-button';\nimport { LicenseButton } from './js/header/license-button';\nimport { InvitationButton } from './js/header/invitation-button';\n\nimport { languageSwitcher } from './js/language-switcher';\nimport { showPartnerConnectForm } from './js/partner-form/show-partner-connect-form';\n\nimport './css/index';\n\nconst Template = new SiteTemplate();\nexport {\n\tlanguageSwitcher,\n\tPartnerForm,\n\tTemplate,\n\tSearchTitle,\n\tInvitationButton,\n\tLicenseButton,\n\tAvatarButton,\n};\n\n// Compatibility\n/**\n * @deprecated\n */\nwindow.showPartnerForm = showPartnerConnectForm;\n\n/**\n * @deprecated\n */\nwindow.B24 = {\n\t/**\n\t * @deprecated\n\t */\n\tlicenseInfoPopup: {\n\t\tshow(popupId, title, content, showDemoButton)\n\t\t{\n\t\t\tconst LicenseInfoPopup = Reflection.getClass('BX.Bitrix24.LicenseInfoPopup');\n\t\t\tif (LicenseInfoPopup)\n\t\t\t{\n\t\t\t\tLicenseInfoPopup.show(popupId, title, content, showDemoButton);\n\t\t\t}\n\t\t},\n\t},\n\n\t/**\n\t * @deprecated\n\t */\n\tupdateCounters(counters, send)\n\t{\n\t\tconst LeftMenu = Reflection.getClass('BX.Intranet.LeftMenu');\n\t\tif (LeftMenu)\n\t\t{\n\t\t\tLeftMenu.updateCounters(counters, send);\n\t\t}\n\t},\n};\n"],"names":["showPartnerConnectForm","params","Loc","setMessage","messages","showPartnerFormPopup","titleBar","getMessage","sendButtonText","options","partnerName","partnerUrl","Popup","Button","ButtonColor","Promise","all","Runtime","loadExtension","popupOptions","className","autoHide","cacheable","zIndex","offsetLeft","offsetTop","width","height","overlay","draggable","restrict","closeByEsc","closeIcon","content","encodeURI","buttons","color","SUCCESS","text","onclick","button","setTimeout","setClocking","showIntegratorApplicationForm","popup","show","PartnerForm","formParams","id","parseInt","Math","random","source","showPartnerOrderForm","Type","isObject","resultParams","Text","getRandom","showHelper","Helper","Reflection","getClass","showConnectForm","showIntegrationOrderForm","ChatMenu","constructor","EventEmitter","subscribe","bind","getChatMenu","menuManager","getById","getCollaborationMenu","event","data","getData","entityId","target","closest","Public","openNavigationItem","fromItemId","from","name","toLowerCase","toItemId","to","chatMenu","unsetActive","setActive","reset","collaborationMenu","siteDir","isMessengerEmbedded","window","location","pathname","toString","startsWith","counters","menus","menu","counterId","counterValue","Object","entries","updateCounter","getBackUrl","backUrl","query","getQueryString","length","ignoredParams","search","slice","isStringFilled","vars","split","checkedIgnoredParams","isArray","result","variable","pair","equal","indexOf","key","value","includes","createToolbarSkeleton","showIconButton","Tag","render","createIconButton","createActionsBarSkeleton","showNavigationPanel","showCounterPanel","rightButtonsCount","createNavigationPanelSkeleton","createCounterPanelSkeleton","createRightButtons","count","wrapper","i","Dom","append","createGridSkeleton","getGridSkeletonRows","createGridSkeletonRow","createKanbanSkeleton","Composite","MemoryCache","isEnabled","isUndefined","frameRequestStart","isReady","BX","frameCache","frameDataInserted","frameRequestFail","showLoader","page","getLiveFeedSkeleton","kanbanOptions","gridOptions","getStubContainer","document","querySelector","getLoaderContainer","remember","getLiveFeedSidebar","getLiveFeedWorkArea","skeleton","container","stub","parentNode","patterns","actionsBarOptions","toolbarOptions","pattern","test","showActionsBar","console","error","top","encodeURIComponent","reason","status","getCompatData","redirectUrl","PULL","moduleId","command","callback","localStorage","get","set","Ajax","url","method","processData","skipBxHeader","emulateOnload","floor","RightBar","innerHeight","redraw","Event","passive","goTopButton","addClass","getContainer","removeClass","ready","rightBar","pageYOffset","dataset","lockRedraw","scrollWidth","documentElement","clientWidth","getElementById","Header","Footer","hide","GoTopButton","setEventNamespace","isShown","hasClass","emit","clientHeight","scrollTo","behavior","flag","setIcon","ButtonIcon","ANGLE_DOWN","ANGLE_UP","ButtonManager","createFromNode","CollaborationMenu","getMenu","counter","decrement","item","getItemById","itemData","getItemData","COUNTER","COUNTER_ID","max","SiteTemplate","getRightBar","getHeader","getFooter","getComposite","isNumber","maxWidth","config","JCClock","setOptions","centerXInline","centerX","centerYInline","centerY","minuteLength","hourLength","popupHeight","inaccuracy","cancelCheckClick","iframeMode","href","Browser","isMobile","referrer","origin","AppLayout","placementInterface","initializePlacement","prototype","cb","isPlainObject","param","keys","SearchTitle","containerId","buttonId","inputId","searchOptions","open","disabled","focus","close","clearSearch","closeResult","then","SearchTitleClass","catch","relatedTarget","AvatarButton","init","signDocumentsCounter","workTimeAvailable","unbindAll","getPopup","setFixed","createSkeletonFromConfig","response","clearBeforeInsertContent","AvatarWidget","getInstance","buttonWrapper","loader","WidgetLoader","bindElement","useAngle","fixed","resolve","reject","ajax","runAction","renderTo","style","stateClasses","forEach","stateClass","state","action","Counter","Color","DANGER","size","Size","MEDIUM","useAirDesign","CounterStyle","FILLED_ALERT","WorkTimeStateIcon","workTimeState","workTimeAction","signDocumentsPullEventName","needActionCount","update","destroy","avatar","eventUserId","userId","handleScroll","scrollY","SidePanel","Instance","getOpenSlidersCount","timeNode","updateClock","now","Date","innerHTML","isAmPmMode","setInterval","date","hours","getHours","minutes","String","getMinutes","padStart","ampm","meridiem","formattedHours","LicenseButton","isCloud","ordersAwaitingPayment","licenseData","Bitrix24LicenseWidget","IntranetLicenseWidget","runComponentAction","mode","CounterColor","delete","isSidePanelDemoLicense","bindAnchors","rules","condition","handler","FeaturePromotersRegistry","getPromoter","code","stopPropagation","preventDefault","isAdmin","BaseEvent","Number","GLOBAL_TARGET","infrastructureForm","contentCallback","secCode","rightBoundary","events","onOpen","w","d","u","s","createElement","async","src","h","getElementsByTagName","insertBefore","onOpenComplete","addEventListener","detail","object","identification","InvitationButton","invitationCounter","InvitationWidget","analyticsLabel","headerPopup","subscribeOnce","shouldShowStructureCounter","LanguageSwitcher","showLanguageListPopup","languages","hideLanguageListPopup","switchPortalLanguage","languageCode","windowScrollHandler","closeByEcs","cachable","onPopupClose","unbind","languageItem","languageItemElement","NAME","IS_BETA","languageSwitcher","Template","showPartnerForm","B24","licenseInfoPopup","popupId","title","showDemoButton","LicenseInfoPopup","updateCounters","send","LeftMenu"],"mappings":"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"}